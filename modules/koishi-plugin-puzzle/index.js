var he=Object.defineProperty;var We=Object.getOwnPropertyDescriptor;var Ke=Object.getOwnPropertyNames;var Ye=Object.prototype.hasOwnProperty;var Ze=(e,t)=>()=>(e&&(t=e(e=0)),t);var L=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ee=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Ke(t))!Ye.call(e,i)&&i!==r&&he(e,i,{get:()=>t[i],enumerable:!(n=We(t,i))||n.enumerable});return e},te=(e,t,r)=>(ee(e,t,"default"),r&&ee(r,t,"default"));var He=e=>ee(he({},"__esModule",{value:!0}),e);var Pe=L((mt,Fe)=>{"use strict";var Z=Object.defineProperty,Je=Object.getOwnPropertyDescriptor,Ve=Object.getOwnPropertyNames,Ge=Object.prototype.hasOwnProperty,h=(e,t)=>Z(e,"name",{value:t,configurable:!0}),Qe=(e,t)=>{for(var r in t)Z(e,r,{get:t[r],enumerable:!0})},Xe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Ve(t))!Ge.call(e,i)&&i!==r&&Z(e,i,{get:()=>t[i],enumerable:!(n=Je(t,i))||n.enumerable});return e},Ee=e=>Xe(Z({},"__esModule",{value:!0}),e),de={};Qe(de,{Time:()=>re,arrayBufferToBase64:()=>Ae,base64ToArrayBuffer:()=>Ce,camelCase:()=>ie,camelize:()=>Te,capitalize:()=>Oe,clone:()=>K,contain:()=>xe,deduplicate:()=>we,deepEqual:()=>Y,defineProperty:()=>_e,difference:()=>ve,hyphenate:()=>et,intersection:()=>ze,is:()=>W,isNullable:()=>U,isPlainObject:()=>ge,makeArray:()=>$e,noop:()=>me,omit:()=>be,paramCase:()=>se,pick:()=>ye,remove:()=>je,sanitize:()=>Se,snakeCase:()=>De,trimSlash:()=>ae,uncapitalize:()=>H,union:()=>ke,valueMap:()=>ne});Fe.exports=Ee(de);function me(){}h(me,"noop");function U(e){return e==null}h(U,"isNullable");function ge(e){return e&&typeof e=="object"&&!Array.isArray(e)}h(ge,"isPlainObject");function ne(e,t){return Object.fromEntries(Object.entries(e).map(([r,n])=>[r,t(n,r)]))}h(ne,"valueMap");function W(e,t){return e in globalThis&&t instanceof globalThis[e]||Object.prototype.toString.call(t).slice(8,-1)===e}h(W,"is");function K(e){return!e||typeof e!="object"?e:Array.isArray(e)?e.map(K):W("Date",e)?new Date(e.valueOf()):W("RegExp",e)?new RegExp(e.source,e.flags):ne(e,K)}h(K,"clone");function Y(e,t,r){return e===t||!r&&U(e)&&U(t)?!0:typeof e!=typeof t||typeof e!="object"||!e||!t?!1:Array.isArray(e)?!Array.isArray(t)||e.length!==t.length?!1:e.every((n,i)=>Y(n,t[i])):Array.isArray(t)?!1:Object.keys({...e,...t}).every(n=>Y(e[n],t[n]))}h(Y,"deepEqual");function ye(e,t,r){if(!t)return{...e};let n={};for(let i of t)(r||i in e)&&(n[i]=e[i]);return n}h(ye,"pick");function be(e,t){if(!t)return{...e};let r={...e};for(let n of t)Reflect.deleteProperty(r,n);return r}h(be,"omit");function _e(e,t,r){return Object.defineProperty(e,t,{writable:!0,value:r})}h(_e,"defineProperty");function xe(e,t){return t.every(r=>e.includes(r))}h(xe,"contain");function ze(e,t){return e.filter(r=>t.includes(r))}h(ze,"intersection");function ve(e,t){return e.filter(r=>!t.includes(r))}h(ve,"difference");function ke(e,t){return Array.from(new Set([...e,...t]))}h(ke,"union");function we(e){return[...new Set(e)]}h(we,"deduplicate");function je(e,t){let r=e.indexOf(t);return r>=0?(e.splice(r,1),!0):!1}h(je,"remove");function $e(e){return Array.isArray(e)?e:U(e)?[]:[e]}h($e,"makeArray");function Ae(e){if(typeof Buffer<"u")return Buffer.from(e).toString("base64");let t="",r=new Uint8Array(e);for(let n=0;n<r.byteLength;n++)t+=String.fromCharCode(r[n]);return btoa(t)}h(Ae,"arrayBufferToBase64");function Ce(e){if(typeof Buffer<"u")return Buffer.from(e,"base64").buffer;let t=atob(e.replace(/\s/g,"")),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r}h(Ce,"base64ToArrayBuffer");function Oe(e){return e.charAt(0).toUpperCase()+e.slice(1)}h(Oe,"capitalize");function H(e){return e.charAt(0).toLowerCase()+e.slice(1)}h(H,"uncapitalize");function ie(e){return e.replace(/[_-][a-z]/g,t=>t.slice(1).toUpperCase())}h(ie,"camelCase");function se(e){return H(e).replace(/_/g,"-").replace(/.[A-Z]+/g,t=>t[0]+"-"+t.slice(1).toLowerCase())}h(se,"paramCase");function De(e){return H(e).replace(/-/g,"_").replace(/.[A-Z]+/g,t=>t[0]+"_"+t.slice(1).toLowerCase())}h(De,"snakeCase");var Te=ie,et=se;function ae(e){return e.replace(/\/$/,"")}h(ae,"trimSlash");function Se(e){return e.startsWith("/")||(e="/"+e),ae(e)}h(Se,"sanitize");var re;(e=>{e.millisecond=1,e.second=1e3,e.minute=e.second*60,e.hour=e.minute*60,e.day=e.hour*24,e.week=e.day*7;let t=new Date().getTimezoneOffset();function r(a){t=a}e.setTimezoneOffset=r,h(r,"setTimezoneOffset");function n(){return t}e.getTimezoneOffset=n,h(n,"getTimezoneOffset");function i(a=new Date,f){return typeof a=="number"&&(a=new Date(a)),f===void 0&&(f=t),Math.floor((a.valueOf()/e.minute-f)/1440)}e.getDateNumber=i,h(i,"getDateNumber");function d(a,f){let F=new Date(a*e.day);return f===void 0&&(f=t),new Date(+F+f*e.minute)}e.fromDateNumber=d,h(d,"fromDateNumber");let g=/\d+(?:\.\d+)?/.source,y=new RegExp(`^${["w(?:eek(?:s)?)?","d(?:ay(?:s)?)?","h(?:our(?:s)?)?","m(?:in(?:ute)?(?:s)?)?","s(?:ec(?:ond)?(?:s)?)?"].map(a=>`(${g}${a})?`).join("")}$`);function j(a){let f=y.exec(a);return f?(parseFloat(f[1])*e.week||0)+(parseFloat(f[2])*e.day||0)+(parseFloat(f[3])*e.hour||0)+(parseFloat(f[4])*e.minute||0)+(parseFloat(f[5])*e.second||0):0}e.parseTime=j,h(j,"parseTime");function z(a){let f=j(a);return f?a=Date.now()+f:/^\d{1,2}(:\d{1,2}){1,2}$/.test(a)?a=`${new Date().toLocaleDateString()}-${a}`:/^\d{1,2}-\d{1,2}-\d{1,2}(:\d{1,2}){1,2}$/.test(a)&&(a=`${new Date().getFullYear()}-${a}`),a?new Date(a):new Date}e.parseDate=z,h(z,"parseDate");function b(a){let f=Math.abs(a);return f>=e.day-e.hour/2?Math.round(a/e.day)+"d":f>=e.hour-e.minute/2?Math.round(a/e.hour)+"h":f>=e.minute-e.second/2?Math.round(a/e.minute)+"m":f>=e.second?Math.round(a/e.second)+"s":a+"ms"}e.format=b,h(b,"format");function _(a,f=2){return a.toString().padStart(f,"0")}e.toDigits=_,h(_,"toDigits");function A(a,f=new Date){return a.replace("yyyy",f.getFullYear().toString()).replace("yy",f.getFullYear().toString().slice(2)).replace("MM",_(f.getMonth()+1)).replace("dd",_(f.getDate())).replace("hh",_(f.getHours())).replace("mm",_(f.getMinutes())).replace("ss",_(f.getSeconds())).replace("SSS",_(f.getMilliseconds(),3))}e.template=A,h(A,"template")})(re||(re={}))});var Ne=L((gt,Be)=>{var tt=Object.defineProperty,k=(e,t)=>tt(e,"name",{value:t,configurable:!0}),$=Pe(),Me=Symbol.for("satori.element");function V(e){return e&&typeof e=="object"&&e[Me]}k(V,"isElement");function oe(e){if(typeof e=="string"||typeof e=="number"||typeof e=="boolean"){if(e=""+e,e)return M("text",{content:e})}else{if(V(e))return e;if(!(0,$.isNullable)(e))throw new TypeError(`Invalid content: ${e}`)}}k(oe,"toElement");function J(e){return Array.isArray(e)?e.map(oe).filter(t=>t):[oe(e)].filter(t=>t)}k(J,"toElementArray");var G=class{get data(){return this.attrs}toString(e=!1){if(this.type==="text")return e?this.attrs.content:M.escape(this.attrs.content);let t=this.children.map(n=>n.toString(e)).join("");if(e)return t;let r=Object.entries(this.attrs).map(([n,i])=>(0,$.isNullable)(i)?"":(n=(0,$.hyphenate)(n),i===!0?` ${n}`:i===!1?` no-${n}`:` ${n}="${M.escape(""+i,!0)}"`)).join("");return this.children.length?`<${this.type}${r}>${t}</${this.type}>`:`<${this.type}${r}/>`}};k(G,"ElementConstructor");(0,$.defineProperty)(G,"name","Element");(0,$.defineProperty)(G.prototype,Me,!0);function M(e,...t){let r=Object.create(G.prototype),n={},i=[];if(t[0]&&typeof t[0]=="object"&&!V(t[0])&&!Array.isArray(t[0])){let d=t.shift();for(let[g,y]of Object.entries(d))(0,$.isNullable)(y)||(g==="children"?t.push(...(0,$.makeArray)(y)):n[g]=y)}for(let d of t)i.push(...J(d));return Object.assign(r,{type:e,attrs:n,children:i})}k(M,"Element");var rt=new Function("expr","context",`
  try {
    with (context) {
      return eval(expr)
    }
  } catch {}
`);(e=>{e.jsx=e,e.jsxs=e,e.jsxDEV=e,e.Fragment="template";function t(o,s){return typeof o!="string"?J(o):e.parse(o,s)}e.normalize=t,k(t,"normalize");function r(o,s=!1){let l=o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");return s?l.replace(/"/g,"&quot;"):l}e.escape=r,k(r,"escape");function n(o){return o.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#(\d+);/g,(s,l)=>l==="38"?s:String.fromCharCode(+l)).replace(/&#x([0-9a-f]+);/gi,(s,l)=>l==="26"?s:String.fromCharCode(parseInt(l,16))).replace(/&(amp|#38|#x26);/g,"&")}e.unescape=n,k(n,"unescape");function i(o,s={}){var l;let p=a(o);return s.caret?s.type&&((l=p[0])==null?void 0:l.type)!==s.type?void 0:p[0]:y(p,s.type||"*")[0]}e.from=i,k(i,"from");let d=/ *([ >+~]) */g;function g(o){return o.split(",").map(s=>{let l=[];s=s.trim();let p,w=" ";for(;p=d.exec(s);)l.push({type:s.slice(0,p.index),combinator:w}),w=p[1],s=s.slice(p.index+p[0].length);return l.push({type:s,combinator:w}),l})}e.parseSelector=g,k(g,"parseSelector");function y(o,s){if(typeof o=="string"&&(o=a(o)),typeof s=="string"&&(s=g(s)),!s.length)return;let l=[],p=[];for(let[w,C]of o.entries()){let D=[],v=[...s,...l];l=[];let S=!1;for(let c of v){let{type:m,combinator:x}=c[0];(m===C.type||m==="*")&&(c.length===1?S=!0:[" ",">"].includes(c[1].combinator)?D.push(c.slice(1)):c[1].combinator==="+"?l.push(c.slice(1)):s.push(c.slice(1))),x===" "&&D.push(c)}S&&p.push(o[w]),p.push(...y(C.children,D))}return p}e.select=y,k(y,"select");function j(o,s){var l;if(o=o.trim(),!/^[\w.]+$/.test(o))return(l=rt(o,s))!=null?l:"";let p=s;for(let w of o.split("."))if(p=p[w],(0,$.isNullable)(p))return"";return p??""}e.interpolate=j,k(j,"interpolate");let z=/<!--[\s\S]*?-->|<(\/?)([^!\s>/]*)([^>]*?)\s*(\/?)>/,b=/([^\s=]+)(?:="([^"]*)"|='([^']*)')?/g,_=/([^\s=]+)(?:="([^"]*)"|='([^']*)'|=\{([^}]+)\})?/g,A=/\{([^}]*)\}/;function a(o,s){let l=[];function p(c){c&&l.push(e("text",{content:c}))}k(p,"pushText");let w=s?_:b,C;for(;C=z.exec(o);){D(o.slice(0,C.index));let[c,m,x,E,T]=C;if(o=o.slice(C.index+c.length),c.startsWith("<!"))continue;let R={source:c,type:x||e.Fragment,close:m,empty:T,attrs:{}},fe;for(;fe=w.exec(E);){let[ht,q,Ie,ue=Ie,pe]=fe;pe?R.attrs[(0,$.camelize)(q)]=j(pe,s):(0,$.isNullable)(ue)?q.startsWith("no-")?R.attrs[(0,$.camelize)(q.slice(3))]=!1:R.attrs[(0,$.camelize)(q)]=!0:R.attrs[(0,$.camelize)(q)]=n(ue)}l.push(R)}D(o);function D(c){if(c=c.replace(/^\s*\n\s*/,"").replace(/\s*\n\s*$/,""),s){let m;for(;m=A.exec(c);){let[x,E]=m;p(n(c.slice(0,m.index))),c=c.slice(m.index+x.length);let T=j(E,s);l.push(...J(T))}}p(n(c))}k(D,"parseContent");let v=[e(e.Fragment)];function S(c){for(;c>0;c--){let{children:m}=v.shift(),{source:x}=v[0].children.pop();v[0].children.push(e("text",{content:x})),v[0].children.push(...m)}}k(S,"rollback");for(let c of l)if(V(c))v[0].children.push(c);else if(c.close){let m=0;for(;m<v.length&&v[m].type!==c.type;)m++;if(m===v.length)v[0].children.push(e("text",{content:c.source}));else{S(m);let x=v.shift();delete x.source}}else{let m=e(c.type,c.attrs);v[0].children.push(m),c.empty||(m.source=c.source,v.unshift(m))}return S(v.length-1),v[0].children}e.parse=a,k(a,"parse");function f(o,s,l){let p=typeof o=="string"?a(o):o,w=[];return p.forEach(C=>{var D,v;let{type:S,attrs:c,children:m}=C,x=(v=(D=s[S])!=null?D:s.default)!=null?v:!0;typeof x=="function"&&(x=x(c,m,l)),x===!0?w.push(e(S,c,f(m,s,l))):x!==!1&&w.push(...t(x))}),typeof o=="string"?w.join(""):w}e.transform=f,k(f,"transform");async function F(o,s,l){let p=typeof o=="string"?a(o):o,w=(await Promise.all(p.map(async C=>{var D,v;let{type:S,attrs:c,children:m}=C,x=(v=(D=s[S])!=null?D:s.default)!=null?v:!0;return typeof x=="function"&&(x=await x(c,m,l)),x===!0?[e(S,c,await F(m,s,l))]:x!==!1?t(x):[]}))).flat(1);return typeof o=="string"?w.join(""):w}e.transformAsync=F,k(F,"transformAsync");function B(o,...s){return(...l)=>{let p=e(o);return s.forEach((w,C)=>{(0,$.isNullable)(l[C])||(p.attrs[w]=l[C])}),l[s.length]&&Object.assign(p.attrs,l[s.length]),p}}k(B,"createFactory"),e.warn=k(()=>{},"warn");function N(o){return(s,...l)=>{let p="base64://";return typeof l[0]=="string"&&(p=`data:${l.shift()};base64,`),(0,$.is)("Buffer",s)?s=p+s.toString("base64"):(0,$.is)("ArrayBuffer",s)&&(s=p+(0,$.arrayBufferToBase64)(s)),s.startsWith("base64://")&&(0,e.warn)('protocol "base64:" is deprecated and will be removed in the future, please use "data:" instead'),e(o,{...l[0],url:s})}}k(N,"createAssetFactory"),e.text=B("text","content"),e.at=B("at","id"),e.sharp=B("sharp","id"),e.quote=B("quote","id"),e.image=N("image"),e.video=N("video"),e.audio=N("audio"),e.file=N("file")})(M||(M={}));Be.exports=M});var I={};import*as bt from"https://registry.koishi.chat/modules/koishi/index.js";var Re=Ze(()=>{te(I,bt)});var Le=L(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.Klotsk=void 0;var qe=console.log,le=class{constructor(t){this.cmd_strs="",this.theme=[],this.drctn_dist={U:[-1,0],D:[1,0],L:[0,-1],R:[0,1]},this.drctn_list=["U","D","L","R"],this.mode=t,this.klotsk=[],this.num=1,this.crtpuzzle=[];for(let n=0;n<this.mode;n++){var r=[];for(let i=0;i<this.mode;i++)r.push(this.num),this.num++;this.crtpuzzle.push([].concat(r)),this.klotsk.push([].concat(r))}this.crtpuzzle[this.mode-1][this.mode-1]=0,this.klotsk[this.mode-1][this.mode-1]=0,this.start_time=new Date().getTime(),this.end_time=0,this.shfl()}find_0(){for(let t=0;t<this.mode;t++)for(let r=0;r<this.mode;r++)if(this.klotsk[t][r]==0)return[t,r]}move(t){let[r,n]=this.find_0();if(r==0&&t=="U")return"";if(r==this.mode-1&&t=="D")return"";if(n==0&&t=="L")return"";if(n==this.mode-1&&t=="R")return"";let[i,d]=this.drctn_dist[t],g=this.klotsk[i+r][d+n];return this.klotsk[r][n]=g,this.klotsk[i+r][d+n]=0,t}check(){for(let t=0;t<this.mode;t++)for(let r=0;r<this.mode;r++)if(this.klotsk[t][r]!=this.crtpuzzle[t][r])return!1;return!0}move_sqnc(t){this.cmd_strs="";let r=t.split("");for(var n in r){var i=this.move(r[n]);if(this.cmd_strs+=i,this.check()){let d=this.duration();return qe(`已还原,用时${d}`),this.logf(),!0}}return!1}shfl(){for(let t=0;t<1e3;t++){let r=(Math.random()*3).toFixed(0);this.move(this.drctn_list[r])}}logf(){for(var t in this.klotsk)qe(this.klotsk[t])}duration(){let r=new Date().getTime()-this.start_time;return this.strftime(r)}strftime(t){let r=Math.floor(t/3600),n=Math.floor(t%3600/60),i=Math.floor(t%60);return`${r}:${n}:${i}`}};Q.Klotsk=le});var Ue=L((xt,nt)=>{nt.exports={commands:{puzzle:{description:"数字华容道",options:{mode:"模式,示例：pz -m 5",ranke:"排行榜,示例 pz - r 5",size:"图片大小，单位：px，示例：pz -s 100"},messages:{"bad-mode":"模式不支持,仅支持(3-5阶)",gameover:"游戏结束",notFound:"游戏不存在"}},def:{description:"自定义华容道",messages:{"bad-mode":"模式不支持,仅支持(3-5阶)"}}}}});var pt=L(u=>{Object.defineProperty(u,"__esModule",{value:!0});u.apply=u.draw_img=u.quickSort=u.add_scroe=u.game=u.replace_n=u.find_color=u.theme=u.Config=u.log=u.usage=u.name=void 0;var O=Ne(),ce=(Re(),He(I)),it=Le();u.name="puzzle";u.usage=`
## 注意事项
> 原游戏 <a href="http://tapsss.com">扫雷联萌</a>
本插件仅供学习参考，请勿用于商业行为
对于部署者行为及所产生的任何纠纷， Koishi 及 koishi-plugin-puzzle 概不负责。
如果有更多文本内容想要修改，可以在<a href="/locales">本地化</a>中修改 zh 内容
`;u.log=console.log;u.Config=ce.Schema.object({maxConcurrency:ce.Schema.number().default(3).description("最大排队数"),size:ce.Schema.number().default(50).description("图片大小")});u.theme=[["#707070","#707070","#707070","#707070","#707070"],["#444444","#00C91A","#00C91A","#00C91A","#00C91A"],["#444444","#008314","#006FFF","#006FFF","#006FFF"],["#444444","#008314","#001EE1","#FF0000","#FF0000"],["#444444","#008314","#001EE1","#BB0000","#ED9512"]];var st=(e,t)=>{var r=0;for(let n=0;n<t;n++)for(let i=0;i<t;i++){if(e==r)return u.theme[n][i];r++}};u.find_color=st;var at=e=>{if(e.indexOf(`
`)==-1)return e;var t=e.replace(`
`," ");return(0,u.replace_n)(t)};u.replace_n=at;var P={},ot=["U","D","L","R"],lt=async(e,t,r,n)=>{let i=P[e],g=t.toUpperCase().split(""),y="";if(g.forEach(z=>{ot.includes(z)&&(y+=z)}),i.move_sqnc(y)){let z=`已还原,执行操作${y},
用时${i.duration()}`;await(0,u.add_scroe)(n,e,r,i.mode);let b=[].concat(i.klotsk);return delete P[e],[z,b]}else return[`执行操作${y},
用时${i.duration()}`,i.klotsk]};u.game=lt;var ct=async(e,t,r,n)=>{let i=await e.database.get("puzzle",["id","score"]);(i.length=0)?await e.database.create("puzzle",{gid:t,uid:r,mode:n,score:1}):await e.database.set("puzzle",[i[0].id],{score:i[0].score+1})};u.add_scroe=ct;function X(e){if(e.length<2)return e;let t=e[0].score,r=[],n=[];for(let i=1;i<e.length;i++)e[i].score>t?r.push(e[i]):n.push(e[i]);return X(r).concat([e[0]]).concat(X(n))}u.quickSort=X;var ft=(e,t,r,n)=>{if(e.puppeteer){let g=[];for(let z=0;z<t.length;z++)for(let b=0;b<t.length;b++){var i=`position: absolute;font-size: ${r/1.7}px;text-align: center;width: ${r}px;height: ${r}px;left: ${b*r+8}px;top: ${z*r+8}px;background: ${(0,u.find_color)(t[z][b],t.length)}`;g.push([i,t[z][b]])}let j=g.map(z=>(0,O.jsx)("div",{style:z[0],children:z[1]}));return j.push((0,O.jsx)("p",{style:`position: absolute;text-align: center;font-size: ${r/3}px;width: ${r*t.length}px;height: ${r/4}px;left: 8px;top: ${t.length*r+8}px`,children:n})),j}else{var d="";for(let g=0;g<t.length;g++){for(let y=0;y<t.length;y++)d+=t[g][y]+" ";d+=`
`}return d+=n,(0,O.jsx)("p",{children:d})}};u.draw_img=ft;function ut(e,t){e.i18n.define("zh",Ue()),e.model.extend("puzzle",{id:"unsigned",gid:"string",uid:"string",mode:"integer",score:"integer"},{autoInc:!0}),e.command("def <prompt:text>").option("size","-s <size:number>").action(({session:r,options:n},i)=>{let d=n.size?n.size:t.size;if(i){let j=i,b=(0,u.replace_n)(j).split(" "),_=Math.sqrt(b.length);if(_>5)return r.text(".bad-mode");let A=[];var g=0;for(let f=0;f<_;f++){var y=[];for(let F=0;F<_;F++)y.push(parseInt(b[g])),g++;A.push(y)}let a=(0,u.draw_img)(e,A,d,i.slice(0,12)+`
`+i.slice(12,-1));return(0,O.jsxs)("html",{children:[(0,O.jsx)("div",{style:{width:_*d+"px",height:_*d+100+"px",background:"transparent"}}),a]})}}),e.command("puzzle <prompt:string>").alias("pz").option("mode","-m <mode:number>").option("opt","-o <opt:string>").option("size","-s <size:number>").option("rank","-r <rank:number>").action(async({session:r,options:n},i)=>{let d=r.channelId,g=r.userId;if(n.rank){let b=await e.database.get("puzzle",{mode:[n.rank]},["uid","score"]),_=X(b),A=[];for(var y in _){var j=_[y];A.push((0,O.jsx)("div",{style:"font-size:40px;width:200px;height:50px",children:`${j.uid}:${j.score}`}))}return A.push((0,O.jsx)("div",{style:"font-size:20px;width:200px;height:50px",children:"----------------------"})),A.push((0,O.jsx)("div",{style:"font-size:20px;width:200px;height:50px",children:`${n.rank}x${n.rank}排行榜`})),(0,O.jsxs)("html",{children:[(0,O.jsx)("div",{style:{width:"200px",height:(b.length+1)*50+30+"px",background:"transparent"}}),A]})}if(n.mode>5)return r.text(".bad-mode");if(n.opt=="stop")return Object.keys(P).includes(d)?(delete P[d],r.text(".gameover")):r.text(".notFound");if(Object.keys(P).includes(d)){let b=await(0,u.game)(d,i||"",g,e),_=(0,u.draw_img)(e,b[1],n.size?n.size:t.size,b[0]);var z=P[d];return(0,O.jsxs)("html",{children:[(0,O.jsx)("div",{style:{width:z.mode*t.size+"px",height:z.mode*t.size+60+"px",background:"transparent"}}),_]})}else if(t.maxConcurrency){if(Object.keys(P).length>=t.maxConcurrency)return r.text(".concurrent-jobs");{let b=new it.Klotsk(n.mode?n.mode:5);P[d]=b;let _=await(0,u.game)(d,i||"",g,e),A=(0,u.draw_img)(e,_[1],n.size?n.size:t.size,_[0]);return(0,O.jsxs)("html",{children:[(0,O.jsx)("div",{style:{width:b.mode*t.size+"px",height:b.mode*t.size+60+"px",background:"transparent"}}),A]})}}})}u.apply=ut});export default pt();
